<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>TaskFlow Tests</title>
    <link href="/node_modules/mocha/mocha.css" rel="stylesheet" />
</head>

<body>
    <div id="mocha"></div>

    <script src="/node_modules/mocha/mocha.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>

    <!-- Test Suites -->
    <script type="module">
        import * as chai from '/node_modules/chai/index.js';

        window.chai = chai;
        mocha.setup('bdd');
        mocha.checkLeaks();

        // Import test files after setting globals expected by legacy suites.
        await import('/tests/utils/tagParser.test.js');
        await import('/tests/utils/tagAutocomplete.test.js');
        await import('/tests/utils/templateAutocomplete.test.js');
        await import('/tests/utils/tagStyle.test.js');
        await import('/tests/utils/taskFilters.test.js');
        await import('/tests/store.test.js');

        // Run tests and expose final stats for Playwright harness.
        const runner = mocha.run();
        runner.on('end', function () {
            window.__MOCHA_RESULTS__ = {
                failures: this.stats.failures,
                passes: this.stats.passes,
                tests: this.stats.tests,
                duration: this.stats.duration
            };
        });
    </script>
</body>

</html>
